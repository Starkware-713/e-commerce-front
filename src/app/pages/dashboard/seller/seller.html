<div class="dashboard-container">
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>ðŸ“Š Jefe de ventas</h2>
        </div>
        <nav class="sidebar-nav">
            <button [class.active]="activeTab === 'dashboard'" (click)="changeTab('dashboard')" class="nav-item">
                <i class="fas fa-chart-line"></i> Dashboard
            </button>
            <button [class.active]="activeTab === 'products'" (click)="changeTab('products')" class="nav-item">
                <i class="fas fa-box"></i> Productos
            </button>
            <button [class.active]="activeTab === 'sales'" (click)="changeTab('sales')" class="nav-item">
                <i class="fas fa-shopping-cart"></i> Ventas
            </button>
            <button [class.active]="activeTab === 'customers'" (click)="changeTab('customers')" class="nav-item">
                <i class="fas fa-users"></i> Clientes
            </button>
            <button [class.active]="activeTab === 'marketing'" (click)="changeTab('marketing')" class="nav-item">
                <i class="fas fa-bullhorn"></i> Marketing
            </button>
        </nav>
    </aside>

    <main class="main-content">
        <!-- Dashboard Overview -->
        @if (activeTab === 'dashboard') {
        <section class="dashboard-overview">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon revenue">ðŸ’°</div>
                    <div class="stat-info">
                        <h3>Total ventas</h3>
                        @if (statistics$ | async; as stats) {
                            <p class="stat-value">${{ stats.totalSales | number:'1.0-0' }}</p>
                            <p class="stat-change" [class.positive]="stats.salesGrowth > 0">
                                {{ stats.salesGrowth | number:'1.1-1' }}% 
                            </p>
                        }
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon products">ðŸ“¦</div>
                    <div class="stat-info">
                        <h3>Productos activos</h3>
                        <p class="stat-value">{{ (statistics$ | async)?.activeProducts }}</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon customers">ðŸ‘¥</div>
                    <div class="stat-info">
                        <h3>Total clientes</h3>
                        <p class="stat-value">{{ (statistics$ | async)?.registeredCustomers }}</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orders">ðŸ“‹</div>
                    <div class="stat-info">
                        <h3>Ordenes pendientes</h3>
                        <p class="stat-value">{{ (statistics$ | async)?.pendingOrders }}</p>
                    </div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>Tendencia de ventas</h3>
                    <!-- Add your preferred charting component here -->
                    <div class="chart-placeholder">Grafico de ventas</div>
                </div>

                <div class="chart-card">
                    <h3>Productos en tendencia</h3>
                    <div class="top-products-list">
                        @for (product of chartData.topProducts; track product.id) {
                            <div class="top-product-item">
                                <span class="product-name">{{ product.name }}</span>
                                <span class="product-sales">${{ product.sales | number:'1.0-0' }}</span>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </section>
        }

        <!-- Products Section -->
        @if (activeTab === 'products') {
        <section class="products-section">
            <div class="section-header">
                <h2>Administracion de productos </h2>
                <div class="search-box">
                    <input type="text" placeholder="Buscar producto..." #productSearch
                           (input)="getFilteredProducts(productSearch.value)">
                </div>
                <button class="add-product-btn" (click)="onAddProduct()">Agregar producto</button>
            </div>

            <div class="data-grid">
                    <thead>
                        <tr>
                            <th class="texto">Productos</th>
                            <th class="texto">Cantidad</th>
                            <th class="texto">Precio</th>
                            <th class="texto">Ventas</th>
                            <th class="texto">Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (products$ | async; as products) {
                            @for (product of products; track product.id) {
                                <tr>
                                    <td>
                                        <div class="product-info">
                                            <img [src]="product.image" [alt]="product.name">
                                            <span>{{ product.name }}</span>
                                        </div>
                                    </td>
                                    <td>{{ product.stock }}</td>
                                    <td>${{ product.price }}</td>
                                    <td>{{ product.sales }}</td>
                                    <td>
                                        <span [class]="'status-badge ' + product.status.toLowerCase()">
                                            {{ product.status }}
                                        </span>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
            </div>
        </section>
        }

        <!-- Sales Section -->
        @if (activeTab === 'sales') {
        <section class="sales-section">
            <div class="section-header">
                <h2>Vistas general de ventas</h2>
                <div class="search-box">
                    <input type="text" placeholder="Search orders..." #salesSearch
                           (input)="getFilteredSales(salesSearch.value)">
                </div>
            </div>

            <div class="data-grid">
                <table>
                    <thead>
                        <tr>
                            <th class="texto">ID de orden</th>
                            <th class="texto">CLiente</th>
                            <th class="texto">Info</th>
                            <th class="texto">Cantidad</th>
                            <th class="texto">Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (sales$ | async; as sales) {
                            @for (sale of sales; track sale.id) {
                                <tr>
                                    <td>#{{ sale.id }}</td>
                                    <td>{{ sale.customerName }}</td>
                                    <td>{{ sale.date | date:'short' }}</td>
                                    <td>${{ sale.total | number:'1.2-2' }}</td>
                                    <td>
                                        <span [class]="'status-badge ' + sale.status.toLowerCase()">
                                            {{ sale.status }}
                                        </span>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </section>
        }

        <!-- Customers Section -->
        @if (activeTab === 'customers') {
        <section class="customers-section">
            <div class="section-header">
                <h2>Administracion de clientes</h2>
                <div class="search-box">
                    <input type="text" placeholder="Search customers..." #customerSearch
                           (input)="getFilteredCustomers(customerSearch.value)">
                </div>
            </div>

            <div class="data-grid">
                <table>
                    <thead>
                        <tr>
                            <th class="texto">Cliente</th>
                            <th class="texto">Email</th>
                            <th class="texto">Orden</th>
                            <th class="texto">Total costos</th>
                            <th class="texto">Ultimo pedido</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (customers$ | async; as customers) {
                            @for (customer of customers; track customer.id) {
                                <tr>
                                    <td>
                                        <div class="customer-info">
                                            <span class="customer-avatar">{{ customer.name[0] }}</span>
                                            <span>{{ customer.name }}</span>
                                        </div>
                                    </td>
                                    <td>{{ customer.email }}</td>
                                    <td>{{ customer.orderCount }}</td>
                                    <td>${{ customer.totalSpent | number:'1.2-2' }}</td>
                                    <td>{{ customer.lastOrderDate | date:'mediumDate' }}</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </section>
        }
    </main>
</div>
