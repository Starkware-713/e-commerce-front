<section class="home-container">
  <div class="home-hero">
    <h1>Bienvenido a TuEmpresa</h1>
    <p>Una plataforma moderna, segura y hecha para vos.</p>
    <a href="/register" class="home-btn">Comenzar</a>
  </div>

  <!-- Estado de carga y errores -->
  @if (loading) {
    <div class="loading-spinner">Cargando productos...</div>
  }

  @if (error) {
    <div class="error-message">
      {{ error }}
    </div>
  }

  <!-- Lista de productos en cartas -->
  @if (products && products.length > 0) {
    <section class="productos-home">
      <h2 class="productos-titulo">Productos destacados</h2>
      <div class="productos-grid">
        @for (product of products; track product.id) {
          <div class="producto-card">
            <img [src]="product.image_url" [alt]="product.name" class="producto-img">
            <div class="producto-info">
              <h3 class="producto-nombre">{{ product.name }}</h3>
              <p class="producto-descripcion">{{ product.description.split(' ').slice(0,18).join(' ') }}<span *ngIf="product.description.split(' ').length > 18">...</span></p>
              <div class="producto-detalles">
                <span class="producto-categoria">{{ product.category }}</span>
                <span class="producto-precio">${{ product.price | number:'1.2-2' }}</span>
                <span class="producto-stock" [class.soldout]="product.stock === 0">
                  {{ product.stock > 0 ? (product.stock + ' disponibles') : 'Sin stock' }}
                </span>
              </div>
              <button class="ver-mas-btn" [routerLink]="['/product', product.id]">Ver m√°s</button>
              <button class="producto-btn" [disabled]="product.stock === 0" (click)="agregarAlCarrito(product)">
                Agregar al carrito
              </button>
            </div>
          </div>
        }
      </div>
    </section>
  }
  @else if (!loading && !error) {
    <div class="no-products">
      <p>No hay productos disponibles en este momento.</p>
    </div>
  }

<section>
  <div class="home-features">
    <div class="feature-card">
      <h3>F√°cil de usar</h3>
      <p>Interfaz intuitiva para que te sientas c√≥modo desde el primer momento.</p>
    </div>
    <div class="feature-card">
      <h3>Seguridad primero</h3>
      <p>Tus datos est√°n protegidos con los m√°s altos est√°ndares.</p>
    </div>
    <div class="feature-card">
      <h3>Accesible</h3>
      <p>Compatible con todos los dispositivos y totalmente responsiva.</p>
    </div>
 </div>
</section>

<div class="carousel-home">
  <div class="carousel-image"></div>
  <div class="reserva-container">
    <div class="tabs">
      <span [class.active]="tabSeleccionado === 0" (click)="seleccionarTab(0)">‚úà VUELOS</span>
      <span [class.active]="tabSeleccionado === 1" (click)="seleccionarTab(1)">üß≥ CHECK IN</span>
      <span [class.active]="tabSeleccionado === 2" (click)="seleccionarTab(2)">‚è± ESTADO DE VUELO</span>
      <span [class.active]="tabSeleccionado === 3" (click)="seleccionarTab(3)">üè∑ MI RESERVA</span>
    </div>

    <!-- TAB 0: Vuelos -->
    <ng-container *ngIf="tabSeleccionado === 0">
      <div class="form-vuelos">
        <div class="tipo-viaje">
          <label><input type="radio" name="tipo" checked> Ida</label>
          <label><input type="radio" name="tipo"> Ida y vuelta</label>
          <label><input type="radio" name="tipo"> Multidestinos</label>
        </div>
        <div class="campos">
          <!-- Campo Origen con autocompletado -->
          <div class="autocomplete-group">
            <input type="text" placeholder="Ciudad de origen" [(ngModel)]="origen" (focus)="mostrarSugerenciasOrigen = true" (input)="filtrarOrigen()" (blur)="ocultarSugerenciasOrigen()">
            <ul *ngIf="mostrarSugerenciasOrigen && sugerenciasOrigen.length > 0" class="suggestions-list">
              <li *ngFor="let sugerencia of sugerenciasOrigen" (mousedown)="seleccionarOrigen(sugerencia)">
                <span class="icon">‚úàÔ∏è</span> {{ sugerencia }}
              </li>
            </ul>
          </div>
          <!-- Campo Destino con autocompletado -->
          <div class="autocomplete-group">
            <input type="text" placeholder="Ciudad de destino" [(ngModel)]="destino" (focus)="mostrarSugerenciasDestino = true" (input)="filtrarDestino()" (blur)="ocultarSugerenciasDestino()">
            <ul *ngIf="mostrarSugerenciasDestino && sugerenciasDestino.length > 0" class="suggestions-list">
              <li *ngFor="let sugerencia of sugerenciasDestino" (mousedown)="seleccionarDestino(sugerencia)">
                <span class="icon">‚úàÔ∏è</span> {{ sugerencia }}
              </li>
            </ul>
          </div>
          <input type="date" placeholder="Partida" [(ngModel)]="partida">
          <input type="date" placeholder="Regreso" [(ngModel)]="regreso" [min]="partida">
          <select [(ngModel)]="pasajeros">
            <option [value]="1">1 Pasajero/a, Economy</option>
            <option [value]="2">2 Pasajeros/as, Business</option>
          </select>
        </div>
        <div class="opciones">
          <label><input type="checkbox" [(ngModel)]="reservarHospedaje"> ¬øDeseas reservar hospedaje?</label>
          <label><input type="checkbox"> B√∫squeda en millas</label>
          <label><input type="checkbox" [(ngModel)]="flexible"> Tengo fechas flexibles</label>
        </div>
        <!-- Selecci√≥n de hospedaje y d√≠as SIEMPRE visible si hay hospedajes disponibles -->
        <div *ngIf="reservarHospedaje" class="hospedaje-seleccion">
          <label for="hospedaje">Elige hospedaje:</label>
          <select id="hospedaje" [(ngModel)]="hospedajeSeleccionado">
            <option *ngFor="let h of hospedajesDisponibles" [ngValue]="h">{{ h.nombre }} - {{ h.destino }}</option>
          </select>
          <label for="diasHospedaje">¬øCu√°ntos d√≠as?</label>
          <input id="diasHospedaje" type="number" min="1" [(ngModel)]="diasHospedaje" />
        </div>
        <button (click)="buscarVuelos()">BUSCAR VUELOS</button>
        <button (click)="agregarReserva()" type="button">Agregar otra reserva</button>
        <div *ngIf="error" class="error-message">{{ error }}</div>
      </div>
    </ng-container>

    <!-- TAB 1: Check-in -->
    <ng-container *ngIf="tabSeleccionado === 1">
      <div class="form-vuelos">
        <button (click)="hacerCheckin()">Realizar Check-in</button>
        <div *ngIf="mensajeCheckin" class="loading-spinner">{{ mensajeCheckin }}</div>
      </div>
    </ng-container>

    <!-- TAB 2: Estado de vuelo -->
    <ng-container *ngIf="tabSeleccionado === 2">
      <div class="form-vuelos">
        <button (click)="consultarEstadoVuelo()">Consultar Estado de Vuelo</button>
        <div *ngIf="estadoVuelo" class="loading-spinner">{{ estadoVuelo }}</div>
      </div>
    </ng-container>

    <!-- TAB 3: Mi reserva -->
    <ng-container *ngIf="tabSeleccionado === 3">
      <div *ngIf="reservas.length > 0; else noReserva">
        <div *ngFor="let reserva of reservas; let i = index" class="reserva-item">
          <h3>Reserva realizada</h3>
          <p><strong>Origen:</strong> {{ reserva.origen }}</p>
          <p><strong>Destino:</strong> {{ reserva.destino }}</p>
          <p><strong>Partida:</strong> {{ reserva.partida }}</p>
          <p *ngIf="reserva.regreso"><strong>Regreso:</strong> {{ reserva.regreso }}</p>
          <p><strong>Pasajeros:</strong> {{ reserva.pasajeros }}</p>
          <p><strong>Clase:</strong> {{ reserva.clase }}</p>
          <p *ngIf="reserva.precio"><strong>Precio:</strong> {{ reserva.precio | currency:'USD' }}</p>
          <p *ngIf="reserva.hospedaje"><strong>Hospedaje:</strong> {{ reserva.hospedaje }}</p>
          <button (click)="eliminarReserva(i)" type="button">Eliminar</button>
          <button (click)="editarReserva(i)" type="button">Editar</button>
          <button (click)="comprarReserva(i)" type="button">Comprar</button>
        </div>
      </div>
      <ng-template #noReserva>
        <div class="loading-spinner">No tienes reservas realizadas a√∫n.</div>
      </ng-template>
    </ng-container>
  </div>
</div>

<h2 class="tituloHosp" *ngIf="mostrarHospedajes && hospedajesDisponibles.length > 0">
  Hospedajes disponibles en {{ destino }}
</h2>
<section class="hospedajes-container" *ngIf="mostrarHospedajes">
  <div *ngIf="hospedajesDisponibles.length === 0" class="no-products">
    <p>No hay hospedajes disponibles para este destino.</p>
  </div>
  <div class="hospedaje-card" *ngFor="let h of hospedajesDisponibles">
    <img [src]="h.imagen" [alt]="h.nombre">
    <div>
      <h3>{{ h.nombre }}</h3>
      <p class="hospedaje-ubicacion">{{ h.destino }}, Argentina</p>
      <p class="hospedaje-desc">{{ h.descripcion }}</p>
      <div class="hospedaje-estrellas">
        <span class="estrella" *ngFor="let e of [].constructor(h.estrellas)">&#9733;</span>
        <span class="estrella" *ngFor="let e of [].constructor(5-h.estrellas)">&#9734;</span>
        <span class="hospedaje-fecha">Reserva: {{ h.fecha }}</span>
      </div>
    </div>
  </div>
</section>

<div class="home-features">
 
</div>
</section>