<div class="cart-container">
  <div class="cart-header">Carrito de Compras</div>

  <ng-container *ngIf="loading">Cargando...</ng-container>
  <ng-container *ngIf="error">{{ error }}</ng-container>

  <table class="cart-table" *ngIf="!loading && !error && cartItems.length">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Categoría</th>
        <th>Precio Unitario</th>
        <th>Cantidad</th>
        <th>Datos Adicionales</th>
        <th>Acción</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of cartItems">
        <td>{{ item.product?.name || item.name }}</td>
        <td>{{ item.product?.category || item.category }}</td>
        <td>${{ item.price }}</td>
        <td>
          <button class="btn-qty" (click)="updateQuantity(item, item.quantity - 1)" [disabled]="item.quantity <= 1">
            <i class="fas fa-minus"></i>
          </button>
          <input type="number" min="1" [value]="item.quantity" (change)="onQuantityInput(item, $event)" style="width: 40px; text-align: center;" />
          <button class="btn-qty" (click)="updateQuantity(item, item.quantity + 1)">
            <i class="fas fa-plus"></i>
          </button>
        </td>
        <td>{{ item.product?.details || '-' }}</td>
        <td>
          <button class="btn-remove" (click)="removeItem(item)">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  @if (!loading && !error && cartItems.length){
    <div class="cart-footer">
    <div class="total">Total: ${{ total.toFixed(2) }}</div>
    <button class="btn-create-order">Crear Pedido</button>
  </div>
  }
  
  @if(!loading && !error && !cartItems.length){
    <div  class="empty-cart">El carrito está vacío.</div>
  }
</div>
